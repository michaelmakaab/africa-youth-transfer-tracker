<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Africa Youth Transfer Tracker</title>
<link href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,opsz,wght@0,9..40,300;0,9..40,500;0,9..40,700;1,9..40,400&family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">
<style>
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
body {
  min-height: 100vh;
  background: #060911;
  color: #E2E8F0;
  font-family: 'DM Sans', -apple-system, sans-serif;
  -webkit-font-smoothing: antialiased;
}
.mono { font-family: 'Space Mono', monospace; }
.header {
  background: linear-gradient(135deg, #0B1120 0%, #0F172A 50%, #0B1120 100%);
  border-bottom: 1px solid #1E293B;
  padding: 28px 32px 24px;
}
.header-inner { max-width: 1200px; margin: 0 auto; }
.header-top { display: flex; align-items: flex-end; justify-content: space-between; margin-bottom: 20px; flex-wrap: wrap; gap: 16px; }
.brand-tag { font-size: 11px; color: #F59E0B; font-weight: 700; letter-spacing: 2px; text-transform: uppercase; margin-bottom: 4px; }
.brand-title { font-size: 28px; font-weight: 700; letter-spacing: -1px; color: #F8FAFC; line-height: 1.1; }
.brand-sub { font-size: 13px; color: #475569; margin-top: 6px; }
.stats { display: flex; gap: 24px; }
.stat { text-align: right; }
.stat-value { font-size: 26px; font-weight: 700; line-height: 1; }
.stat-label { font-size: 10px; color: #475569; letter-spacing: 1px; margin-top: 4px; text-transform: uppercase; }
.view-tabs { display: flex; gap: 0; margin-bottom: 16px; border-bottom: 1px solid #1E293B; }
.view-tab {
  padding: 10px 20px; background: transparent; border: none; border-bottom: 2px solid transparent;
  color: #475569; font-size: 13px; font-weight: 700; font-family: 'Space Mono', monospace;
  cursor: pointer; transition: all 0.15s; letter-spacing: 0.5px;
}
.view-tab:hover { color: #94A3B8; }
.view-tab.active { color: #F59E0B; border-bottom-color: #F59E0B; }
.feed-item {
  display: grid; grid-template-columns: 140px 1fr; gap: 0;
  padding: 14px 16px; border-bottom: 1px solid #1E293B; transition: background 0.15s;
}
.feed-item:hover { background: #0F172A; }
.feed-meta { display: flex; flex-direction: column; gap: 4px; }
.feed-date { font-size: 11px; color: #64748B; }
.feed-player-name { font-size: 13px; font-weight: 700; color: #F1F5F9; }
.feed-player-sub { font-size: 10px; color: #475569; }
.feed-content { display: flex; flex-direction: column; gap: 4px; }
.feed-club { font-size: 13px; color: #CBD5E1; font-weight: 600; }
.feed-detail { font-size: 13px; color: #94A3B8; line-height: 1.5; }
.feed-source { font-size: 11px; color: #64748B; display: flex; align-items: center; gap: 8px; }
@media (max-width: 640px) { .feed-item { grid-template-columns: 1fr; gap: 8px; } }
.filters { display: flex; gap: 12px; align-items: center; flex-wrap: wrap; }
.search-box { position: relative; flex: 1 1 260px; max-width: 320px; }
.search-box input {
  width: 100%; padding: 9px 14px 9px 36px; background: #0B1120;
  border: 1px solid #1E293B; border-radius: 8px; color: #E2E8F0;
  font-size: 13px; font-family: 'DM Sans', sans-serif; outline: none;
}
.search-box input:focus { border-color: #334155; }
.search-box input::placeholder { color: #334155; }
.search-icon { position: absolute; left: 12px; top: 50%; transform: translateY(-50%); color: #475569; font-size: 14px; pointer-events: none; }
.filter-pills { display: flex; gap: 4px; flex-wrap: wrap; }
.filter-pill {
  padding: 7px 14px; border-radius: 8px; border: 1px solid #1E293B;
  background: transparent; color: #475569; font-size: 12px; font-weight: 600;
  font-family: 'DM Sans', sans-serif; cursor: pointer; transition: all 0.15s; white-space: nowrap;
}
.filter-pill:hover { border-color: #334155; color: #94A3B8; }
.filter-pill.active { background: rgba(139,158,183,0.08); }
.country-select {
  padding: 8px 12px; background: #0B1120; border: 1px solid #1E293B;
  border-radius: 8px; color: #94A3B8; font-size: 12px;
  font-family: 'DM Sans', sans-serif; cursor: pointer; outline: none;
}
.country-select option { background: #0B1120; }
.sort-bar { display: flex; align-items: center; gap: 8px; margin-bottom: 12px; }
.sort-label { font-size: 10px; color: #334155; letter-spacing: 1px; }
.sort-btn {
  padding: 5px 12px; border-radius: 6px; border: 1px solid #1E293B;
  background: transparent; color: #475569; font-size: 11px; font-weight: 600;
  font-family: 'Space Mono', monospace; cursor: pointer; transition: all 0.15s;
  display: inline-flex; align-items: center; gap: 4px;
}
.sort-btn:hover { border-color: #334155; color: #94A3B8; }
.sort-btn.active { border-color: #F59E0B66; background: #F59E0B15; color: #F59E0B; }
.sort-arrow { font-size: 10px; }
.tier-legend { max-width: 1200px; margin: 0 auto; padding: 14px 32px 0; display: flex; gap: 16px; align-items: center; flex-wrap: wrap; }
.tier-legend-label { font-size: 10px; color: #334155; letter-spacing: 1px; }
.tier-legend-item { display: flex; align-items: center; gap: 5px; }
.tier-dot { width: 7px; height: 7px; border-radius: 50%; }
.tier-legend-text { font-size: 10px; color: #475569; }
.player-list { max-width: 1200px; margin: 0 auto; padding: 16px 32px 40px; }
.list-info { font-size: 11px; color: #334155; margin-bottom: 12px; }
.player-card {
  background: #0B1120; border: 1px solid rgba(30,41,59,0.5);
  border-radius: 12px; overflow: hidden; margin-bottom: 10px; transition: border-color 0.2s;
}
.player-header {
  display: flex; align-items: center; justify-content: space-between;
  padding: 14px 20px; cursor: pointer; transition: background 0.15s; user-select: none;
}
.player-header:hover { background: #0F172A; }
.player-header.expanded { background: #0F172A; }
.player-left { display: flex; align-items: center; gap: 14px; }
.player-flag { font-size: 22px; }
.player-name { font-weight: 700; font-size: 15px; color: #F1F5F9; letter-spacing: -0.3px; }
.player-meta { font-size: 11px; color: #64748B; margin-top: 3px; }
.player-right { display: flex; align-items: center; gap: 12px; }
.rumor-count { font-size: 11px; color: #475569; }
.chevron { color: #475569; font-size: 18px; transition: transform 0.2s; line-height: 1; display: inline-block; }
.chevron.open { transform: rotate(180deg); }
.new-badge {
  display: inline-block; padding: 2px 8px; border-radius: 999px;
  font-size: 9px; font-weight: 700; letter-spacing: 0.5px;
  color: #38BDF8; background: #0C4A6E; border: 1px solid rgba(56,189,248,0.3);
  margin-left: 8px; vertical-align: middle; animation: pulse-new 2s ease-in-out infinite;
}
@keyframes pulse-new { 0%, 100% { opacity: 1; } 50% { opacity: 0.6; } }
.new-rumor-indicator {
  width: 6px; height: 6px; border-radius: 50%; background: #38BDF8;
  display: inline-block; margin-right: 6px; flex-shrink: 0;
  animation: pulse-new 2s ease-in-out infinite;
}
.status-pill {
  display: inline-block; padding: 3px 12px; border-radius: 999px;
  font-size: 11px; font-weight: 700; letter-spacing: 0.3px;
}
.status-confirmed { color: #34D399; background: #052E16; border: 1px solid rgba(52,211,153,0.25); }
.status-active { color: #F59E0B; background: #422006; border: 1px solid rgba(245,158,11,0.25); }
.status-monitoring { color: #A78BFA; background: #1E1B4B; border: 1px solid rgba(167,139,250,0.25); }
.status-no_rumours { color: #6B7280; background: #1F2937; border: 1px solid rgba(75,85,99,0.25); }
.tier-badge {
  display: inline-flex; align-items: center; gap: 4px; padding: 2px 10px;
  border-radius: 999px; font-size: 11px; font-weight: 700; letter-spacing: 0.5px; white-space: nowrap;
}
.tier-badge .dot { width: 6px; height: 6px; border-radius: 50%; }
.tier-1 { color: #34D399; background: #052E16; border: 1px solid rgba(52,211,153,0.2); }
.tier-1 .dot { background: #34D399; }
.tier-2 { color: #FBBF24; background: #422006; border: 1px solid rgba(251,191,36,0.2); }
.tier-2 .dot { background: #FBBF24; }
.tier-3 { color: #FB923C; background: #431407; border: 1px solid rgba(251,146,60,0.2); }
.tier-3 .dot { background: #FB923C; }
.tier-4 { color: #F87171; background: #450A0A; border: 1px solid rgba(248,113,113,0.2); }
.tier-4 .dot { background: #F87171; }
.card-body { border-top: 1px solid #1E293B; }
.col-headers {
  display: grid; grid-template-columns: 110px 150px 1fr 180px 72px;
  gap: 12px; padding: 8px 16px; border-bottom: 1px solid #1E293B; background: #060D1B;
}
.col-header { font-size: 9px; font-weight: 700; color: #334155; letter-spacing: 1.5px; }
.col-header:last-child { text-align: right; }
.section-toggle {
  padding: 8px 16px; background: #0A0F1A; border-bottom: 1px solid #1E293B;
  cursor: pointer; display: flex; align-items: center; gap: 8px; user-select: none;
}
.section-toggle:hover { background: #0D1321; }
.section-arrow { color: #475569; font-size: 12px; transition: transform 0.15s; display: inline-block; }
.section-arrow.open { transform: rotate(90deg); }
.section-label-archive { font-size: 11px; color: #475569; font-weight: 700; letter-spacing: 0.5px; }
.section-label-recent { font-size: 11px; color: #F59E0B; font-weight: 700; letter-spacing: 0.5px; padding: 8px 16px; background: #0A0F1A; border-bottom: 1px solid #1E293B; }
.rumor-row {
  display: grid; grid-template-columns: 110px 150px 1fr 180px 72px;
  gap: 12px; padding: 10px 16px; border-bottom: 1px solid #1E293B;
  font-size: 13px; line-height: 1.5; align-items: start; transition: background 0.15s;
}
.rumor-row:hover { background: #0F172A; }
.rumor-row.archive { opacity: 0.5; }
.rumor-date { color: #64748B; font-size: 11px; padding-top: 2px; }
.rumor-club { color: #CBD5E1; font-weight: 500; }
.rumor-detail { color: #94A3B8; }
.rumor-source { color: #64748B; font-size: 11px; padding-top: 2px; }
.rumor-tier { text-align: right; }
.no-rumors { padding: 20px 16px; text-align: center; color: #334155; font-size: 13px; }
.no-results { text-align: center; padding: 60px; color: #334155; font-size: 14px; }
.intel-toggle {
  padding: 8px 16px; background: #0A0F1A; border-bottom: 1px solid #1E293B;
  cursor: pointer; display: flex; align-items: center; gap: 8px; user-select: none;
}
.intel-toggle:hover { background: #0D1321; }
.intel-label { font-size: 11px; color: #38BDF8; font-weight: 700; letter-spacing: 0.5px; }
.intel-panel { padding: 14px 16px 16px; background: #080E1C; border-bottom: 1px solid #1E293B; }
.intel-row { display: flex; padding: 6px 0; border-bottom: 1px solid rgba(30,41,59,0.3); }
.intel-row:last-child { border-bottom: none; }
.intel-key {
  width: 130px; min-width: 130px; font-size: 10px; font-weight: 700;
  color: #475569; letter-spacing: 0.8px; text-transform: uppercase; padding-top: 2px;
}
.intel-val { font-size: 13px; color: #CBD5E1; line-height: 1.5; flex: 1; }
.intel-section-title {
  font-size: 10px; font-weight: 700; color: #38BDF8; letter-spacing: 1.5px;
  text-transform: uppercase; padding: 10px 0 6px; border-bottom: 1px solid rgba(56,189,248,0.15);
  margin-bottom: 2px;
}
.intel-section-title:first-child { padding-top: 0; }
.intel-notes { font-size: 12px; color: #94A3B8; line-height: 1.6; padding: 8px 0 2px; font-style: italic; }
.intel-gap { font-size: 11px; color: #334155; font-style: italic; }
@media (max-width: 640px) { .intel-key { width: 100px; min-width: 100px; } }
.hidden { display: none; }
.rumor-mobile-label {
  display: none; font-size: 9px; font-weight: 700; color: #334155;
  letter-spacing: 1px; text-transform: uppercase; margin-bottom: 2px;
}
@media (max-width: 900px) {
  .header { padding: 20px 16px 18px; }
  .player-list { padding: 12px 16px 32px; }
  .tier-legend { padding: 10px 16px 0; }
  .col-headers, .rumor-row { grid-template-columns: 90px 120px 1fr 140px 64px; gap: 8px; }
  .stats { gap: 16px; }
  .stat-value { font-size: 20px; }
}
@media (max-width: 640px) {
  .header-top { flex-direction: column; align-items: flex-start; }
  .stats { align-self: flex-start; }
  .col-headers { display: none; }
  .rumor-row { grid-template-columns: 1fr; gap: 2px; padding: 12px 16px; }
  .rumor-tier { text-align: left; }
  .rumor-mobile-label { display: block; }
  .sort-bar { flex-wrap: wrap; }
}
</style>
</head>
<body>
<div class="header">
  <div class="header-inner">
    <div class="header-top">
      <div>
        <div class="mono brand-tag">Africa Youth Intelligence</div>
        <h1 class="brand-title">Transfer Tracker</h1>
        <p class="mono brand-sub" id="sweepInfo"></p>
      </div>
      <div class="stats">
        <div class="stat">
          <div class="mono stat-value" style="color:#34D399" id="stat-confirmed">0</div>
          <div class="mono stat-label">Confirmed</div>
        </div>
        <div class="stat">
          <div class="mono stat-value" style="color:#F59E0B" id="stat-active">0</div>
          <div class="mono stat-label">Active</div>
        </div>
        <div class="stat">
          <div class="mono stat-value" style="color:#64748B" id="stat-total">0</div>
          <div class="mono stat-label">Total Intel</div>
        </div>
      </div>
    </div>
    <div class="filters">
      <div class="search-box">
        <span class="search-icon" aria-hidden="true">&#x2315;</span>
        <input type="text" id="searchInput" placeholder="Search players, clubs, rumours..." aria-label="Search players, clubs and rumours">
      </div>
      <div class="filter-pills" id="statusFilters" role="group" aria-label="Filter by status">
        <button class="filter-pill active" data-status="all">All Players</button>
        <button class="filter-pill" data-status="confirmed">Confirmed</button>
        <button class="filter-pill" data-status="active">Active Rumours</button>
        <button class="filter-pill" data-status="monitoring">Monitoring</button>
        <button class="filter-pill" data-status="no_rumours">No Rumours</button>
      </div>
      <select class="country-select" id="countryFilter" aria-label="Filter by country">
        <option value="all">All Countries</option>
      </select>
    </div>
  </div>
</div>
<div class="tier-legend mono" role="legend" aria-label="Tier reliability legend">
  <span class="tier-legend-label">TIERS:</span>
  <div class="tier-legend-item"><span class="tier-dot" style="background:#34D399" aria-hidden="true"></span><span class="tier-legend-text">Tier 1 &mdash; Official / Verified</span></div>
  <div class="tier-legend-item"><span class="tier-dot" style="background:#FBBF24" aria-hidden="true"></span><span class="tier-legend-text">Tier 2 &mdash; Reliable Sources</span></div>
  <div class="tier-legend-item"><span class="tier-dot" style="background:#FB923C" aria-hidden="true"></span><span class="tier-legend-text">Tier 3 &mdash; Developing</span></div>
  <div class="tier-legend-item"><span class="tier-dot" style="background:#F87171" aria-hidden="true"></span><span class="tier-legend-text">Tier 4 &mdash; Speculative</span></div>
</div>
<div class="player-list">
  <div class="view-tabs" role="tablist" aria-label="View mode">
    <button class="view-tab active" id="tabPlayers" role="tab" aria-selected="true" aria-controls="playerView" onclick="switchView('players')">PLAYERS</button>
    <button class="view-tab" id="tabFeed" role="tab" aria-selected="false" aria-controls="feedContainer" onclick="switchView('feed')">LATEST INTEL</button>
  </div>
  <div id="feedContainer" class="hidden" role="tabpanel" aria-labelledby="tabFeed"></div>
  <div id="playerView" role="tabpanel" aria-labelledby="tabPlayers">
    <div class="sort-bar" role="group" aria-label="Sort players">
      <span class="mono sort-label">SORT:</span>
      <button class="sort-btn active" data-sort="status" aria-pressed="true"><span class="sort-arrow" aria-hidden="true">&#9660;</span> Status</button>
      <button class="sort-btn" data-sort="name" aria-pressed="false"><span class="sort-arrow" aria-hidden="true">&#9660;</span> Name</button>
      <button class="sort-btn" data-sort="country" aria-pressed="false"><span class="sort-arrow" aria-hidden="true">&#9660;</span> Country</button>
      <button class="sort-btn" data-sort="rumors" aria-pressed="false"><span class="sort-arrow" aria-hidden="true">&#9660;</span> Rumours</button>
    </div>
    <div class="mono list-info" id="listInfo" aria-live="polite"></div>
    <div id="playerContainer" role="list"></div>
  </div>
</div>
<script>
// ── DATA (injected by build.sh) ──────────────────────────────────────
const PLAYERS_DATA = {
  "meta": {
    "lastSweep": "Feb 16, 2026",
    "sweepNumber": 5,
    "playerCount": 21
  },
  "players": [
    {"id":1,"name":"Issouf Dabo","country":"Burkina Faso","flag":"\ud83c\udde7\ud83c\uddeb","position":"CB","birthYear":2009,"currentClub":"New Stars FC","status":"active","sweepTier":"B","altSpellings":["Issouf Dabo"],"confusionRisk":"Issouf Dayo (b.1992, Stade Malien)","rumors":[
      {"date":"Dec 5, 2025","club":"QPR","detail":"QPR launched concrete offensive after multiple scout observations \u2014 convinced by defensive maturity & 1.93m frame","source":"AfricaFoot (exclusive)","tier":2,"status":"Active Interest","recent":true},
      {"date":"Dec 7, 2025","club":"Lorient / Leverkusen","detail":"Lorient and Bayer Leverkusen also closely following alongside QPR","source":"Africa Top Sports","tier":3,"status":"Monitoring","recent":true}
    ]},
    {"id":2,"name":"El Hadj Malick Ciss\u00e9","country":"Senegal","flag":"\ud83c\uddf8\ud83c\uddf3","position":"CB","birthYear":2008,"currentClub":"Be Sport Academy","status":"confirmed","sweepTier":"A","altSpellings":["El Hadji Cisse","Malik Ciss\u00e9","Malick Cisse","El Hadj Cisse"],"confusionRisk":null,"rumors":[
      {"date":"Oct 25, 2025","club":"Burnley / Ipswich","detail":"Interest from Burnley and Ipswich at youth level","source":"AfricaSoccer.com","tier":3,"status":"Early Interest","recent":false},
      {"date":"Jan 25, 2026","club":"AC Milan","detail":"La Gazzetta reports Milan close to signing for Milan Futuro. Barca & Leipzig also tracked","source":"La Gazzetta dello Sport","tier":2,"status":"Advanced Negotiations","recent":true},
      {"date":"Jan 27, 2026","club":"AC Milan","detail":"Fabrizio Romano confirms deal sealed. Medical & signatures incoming","source":"Fabrizio Romano, Matteo Moretto","tier":1,"status":"CONFIRMED","recent":true},
      {"date":"Jan 30, 2026","club":"AC Milan","detail":"Contract signed \u2014 Milan Futuro. Fee: \u20ac750k + bonuses up to \u20ac2m. 4.5yr deal until 2030","source":"AC Milan Official, MilanReports, AfricaFoot","tier":1,"status":"SIGNED","recent":true}
    ]},
    {"id":3,"name":"Toure Alassane","country":"Ivory Coast","flag":"\ud83c\udde8\ud83c\uddee","position":"FW","birthYear":2009,"currentClub":"RC Abidjan U19","status":"no_rumours","sweepTier":"C","altSpellings":[],"confusionRisk":null,"rumors":[]},
    {"id":4,"name":"Yao Hubert","country":"Ivory Coast","flag":"\ud83c\udde8\ud83c\uddee","position":"FW/LW","birthYear":2009,"currentClub":"FC San Pedro","status":"active","sweepTier":"B","altSpellings":["Hubert Yao"],"confusionRisk":null,"rumors":[
      {"date":"Jan 15, 2026","club":"FC Nordsj\u00e6lland","detail":"Nordsj\u00e6lland close to signing. Explosive, direct \u2014 attacks with both feet. ~190cm. Brother of Gervinho","source":"AfricaFoot","tier":2,"status":"Advanced Negotiations","recent":true},
      {"date":"Jan 13, 2026","club":"FC Nordsj\u00e6lland","detail":"Bold.dk confirms FCN & Right to Dream close to agreement","source":"Bold.dk","tier":2,"status":"Corroborated","recent":true}
    ]},
    {"id":5,"name":"Asharaf Loukmane Tapsoba","country":"Burkina Faso","flag":"\ud83c\udde7\ud83c\uddeb","position":"ST","birthYear":2010,"currentClub":"R\u00e9al du Faso","status":"active","sweepTier":"B","altSpellings":["Ashraf Loukman Tapsoba","Loukmane Tapsoba"],"confusionRisk":"Edmond Tapsoba (b.1999, Bayer Leverkusen)","rumors":[
      {"date":"Apr 10, 2025","club":"Hammarby / Leverkusen / Lille","detail":"Hammarby, Leverkusen, Lille & RS Berkane all tracking","source":"AfricaFoot (exclusive)","tier":2,"status":"Multiple Interest","recent":false},
      {"date":"Jul 8, 2025","club":"Hammarby","detail":"Hammarby delegation visited Ouagadougou. Pre-contract sealed + partnership with R\u00e9al du Faso","source":"AfricaFoot (exclusive)","tier":2,"status":"Pre-contract","recent":false},
      {"date":"Nov 7, 2025","club":"Man United","detail":"Man Utd closely monitoring at U17 World Cup","source":"AfricaFoot, Peoples Person","tier":2,"status":"Scouting","recent":false},
      {"date":"Dec 5, 2025","club":"Chelsea","detail":"Chelsea stepped up campaign. Man Utd leading but Chelsea surging. Likened to Drogba","source":"TEAMtalk","tier":2,"status":"Long-term (2027)","recent":true},
      {"date":"Dec 5, 2025","club":"Multiple (10+ clubs)","detail":"Arsenal, Liverpool, Spurs, Barca, Atletico, PSG, Marseille, Leipzig, BVB, Juve all scouting","source":"TEAMtalk","tier":2,"status":"Scouting","recent":true},
      {"date":"Dec 5, 2025","club":"Chelsea","detail":"Chelsea also discussing teammate Mohamed Zongo (AM, b.2009)","source":"TEAMtalk","tier":2,"status":"Parallel Interest","recent":true}
    ]},
    {"id":6,"name":"Souleymane Faye","country":"Senegal","flag":"\ud83c\uddf8\ud83c\uddf3","position":"\u2014","birthYear":2010,"currentClub":"Sahel F.C","status":"no_rumours","sweepTier":"C","altSpellings":[],"confusionRisk":"Souleymane Faye (b.2003, Sporting CP)","rumors":[]},
    {"id":7,"name":"Cheick Malo","country":"Ivory Coast","flag":"\ud83c\udde8\ud83c\uddee","position":"MF","birthYear":2009,"currentClub":"San Pedro FC","status":"no_rumours","sweepTier":"C","altSpellings":[],"confusionRisk":null,"rumors":[]},
    {"id":8,"name":"Souleymane Doumbia","country":"Mali","flag":"\ud83c\uddf2\ud83c\uddf1","position":"DF","birthYear":2008,"currentClub":"Derby Academy","status":"no_rumours","sweepTier":"C","altSpellings":["Soulaymane Doumbia"],"confusionRisk":null,"rumors":[]},
    {"id":9,"name":"Mahamadou Traore","country":"Mali","flag":"\ud83c\uddf2\ud83c\uddf1","position":"MF","birthYear":2009,"currentClub":"Players Dreams","status":"active","sweepTier":"B","altSpellings":["Mamadou Traor\u00e9","Mahamadou Traor\u00e9"],"confusionRisk":"Mamadou Traor\u00e9 (b.1994, Dalian Yingbo)","rumors":[
      {"date":"Feb 8, 2026","club":"Randers FC","detail":"Randers FC (Denmark) invited Traore for trial. Villarreal & Monaco also interested","source":"AfricaFoot via Foot Africa","tier":2,"status":"Trial Invitation","recent":false},
      {"date":"Feb 10, 2026","club":"Eintracht Frankfurt","detail":"Frankfurt have almost finalised deal \u2014 ~3yr contract. Traore heading to Bundesliga","source":"AfricaFoot (exclusive)","tier":2,"status":"Advanced Negotiations","recent":true},
      {"date":"Feb 12, 2026","club":"Eintracht Frankfurt","detail":"Visa delays \u2014 Traore & camp actively seeking German visa. Will join Frankfurt U17 initially","source":"AfricaFoot (update)","tier":2,"status":"Pending Travel","recent":true}
    ]},
    {"id":10,"name":"Mor Talla Ndiaye","country":"Senegal","flag":"\ud83c\uddf8\ud83c\uddf3","position":"CB","birthYear":2008,"currentClub":"Liverpool FC U21s","status":"confirmed","sweepTier":"A","altSpellings":["El Hadji Mor Talla Ndiaye","Talla Ndiaye","Mor Talla"],"confusionRisk":"Multiple Ndiaye players in Senegalese football","rumors":[
      {"date":"Jan 5, 2026","club":"Liverpool FC","detail":"Senegalese journalist reports Liverpool 'expected' to sign. Multiple PL clubs pursuing","source":"This Is Anfield, Saikou Seydi","tier":2,"status":"Advanced Negotiations","recent":true},
      {"date":"Jan 10, 2026","club":"Liverpool FC","detail":"Liverpool complete signing from Amiti\u00e9 FC. Fee ~\u00a31m. 4.5yr contract","source":"LiverpoolFC.com, The Athletic","tier":1,"status":"SIGNED","recent":true},
      {"date":"Jan 26, 2026","club":"Liverpool FC","detail":"Minor medical issue found \u2014 not expected on sidelines long. Missed U21s vs Leeds","source":"Liverpool.com","tier":2,"status":"Integration","recent":true}
    ]},
    {"id":11,"name":"El Hadj Yamar Ndiaye","country":"Senegal","flag":"\ud83c\uddf8\ud83c\uddf3","position":"FW","birthYear":2009,"currentClub":"Challenge F.C","status":"no_rumours","sweepTier":"C","altSpellings":[],"confusionRisk":null,"rumors":[]},
    {"id":12,"name":"Ettienne Mendy","country":"Senegal","flag":"\ud83c\uddf8\ud83c\uddf3","position":"FW/RW","birthYear":2008,"currentClub":"Diambars FC","status":"monitoring","sweepTier":"C","altSpellings":["Etienne Mendy"],"confusionRisk":"\u00c9douard Mendy (b.1992, Al-Ahli)","rumors":[
      {"date":"Sep 11, 2025","club":"Man United","detail":"Mendy on trial at Carrington. Eligible summer 2026. 'Extraordinarily effective dribbler'","source":"13football, Scouts Attending","tier":2,"status":"Trial","recent":false},
      {"date":"Sep 12, 2025","club":"Man United","detail":"AfricaFoot rates as top 3 Senegal U17 prospect. Needs physical development","source":"United In Focus","tier":2,"status":"Assessment","recent":false}
    ]},
    {"id":13,"name":"James Bogere","country":"Uganda","flag":"\ud83c\uddfa\ud83c\uddec","position":"FW","birthYear":2008,"currentClub":"Aarhus GF U19","status":"confirmed","sweepTier":"A","altSpellings":[],"confusionRisk":null,"rumors":[
      {"date":"Nov 21, 2025","club":"Multiple clubs","detail":"Man Utd, Brentford, Brighton, Genk & Aarhus monitoring","source":"Sportsboom","tier":3,"status":"Multiple Interest","recent":false},
      {"date":"Dec 10, 2025","club":"Aarhus GF","detail":"Bogere & teammate sign professional contracts with Danish Superliga leaders AGF. Free transfer","source":"Kawowo, PanAfricaFootball","tier":1,"status":"CONFIRMED","recent":true},
      {"date":"Feb 2, 2026","club":"Aarhus GF","detail":"Transfer officially registered. Contract until Jun 30, 2028. U19 Boys League","source":"AfricaSoccer, Pulse Sports","tier":1,"status":"SIGNED","recent":true}
    ]},
    {"id":14,"name":"Adama Some","country":"Ivory Coast","flag":"\ud83c\udde8\ud83c\uddee","position":"MF","birthYear":2009,"currentClub":"ISCA","status":"no_rumours","sweepTier":"C","altSpellings":[],"confusionRisk":null,"rumors":[]},
    {"id":15,"name":"Delfim Luwawu","country":"Angola","flag":"\ud83c\udde6\ud83c\uddf4","position":"DM","birthYear":2008,"currentClub":"AFA","status":"no_rumours","sweepTier":"C","altSpellings":[],"confusionRisk":null,"rumors":[]},
    {"id":16,"name":"Prince Hamed Ouedraogo","country":"Burkina Faso","flag":"\ud83c\udde7\ud83c\uddeb","position":"GK","birthYear":2009,"currentClub":"R\u00e9al du Faso","status":"no_rumours","sweepTier":"C","altSpellings":[],"confusionRisk":null,"rumors":[]},
    {"id":17,"name":"Vincent Gomis","country":"Senegal","flag":"\ud83c\uddf8\ud83c\uddf3","position":"GK","birthYear":2008,"currentClub":"G\u00e9n\u00e9ration Foot","status":"no_rumours","sweepTier":"C","altSpellings":[],"confusionRisk":null,"rumors":[]},
    {"id":18,"name":"Il\u00eddio Panda","country":"Angola","flag":"\ud83c\udde6\ud83c\uddf4","position":"FW","birthYear":2008,"currentClub":"Petro Luanda","status":"no_rumours","sweepTier":"C","altSpellings":[],"confusionRisk":null,"rumors":[]},
    {"id":19,"name":"Ysso Donatien Bama","country":"Burkina Faso","flag":"\ud83c\udde7\ud83c\uddeb","position":"CB","birthYear":2007,"currentClub":"Rahimo FC","status":"no_rumours","sweepTier":"C","altSpellings":[],"confusionRisk":null,"rumors":[]},
    {"id":20,"name":"Pape S\u00e9mou San\u00e9","country":"Senegal","flag":"\ud83c\uddf8\ud83c\uddf3","position":"FW/RW","birthYear":2007,"currentClub":"Casa Sports","status":"no_rumours","sweepTier":"C","altSpellings":[],"confusionRisk":null,"rumors":[]},
    {"id":21,"name":"Mouhamed Diop","country":"Senegal","flag":"\ud83c\uddf8\ud83c\uddf3","position":"FW","birthYear":2009,"currentClub":"AJEL Rufisque","status":"active","sweepTier":"B","altSpellings":[],"confusionRisk":null,"rumors":[
      {"date":"Dec 18, 2025","club":"ES S\u00e9tif","detail":"ES S\u00e9tif (Algeria) closely tracking. Top scorer in Senegalese Ligue 1","source":"AfricaFoot (exclusive)","tier":2,"status":"Scouting","recent":false},
      {"date":"Dec 23, 2025","club":"ES S\u00e9tif","detail":"S\u00e9tif submit \u20ac70k offer. AJEL demanding \u20ac200k. Negotiations ongoing","source":"AfricaFoot (exclusive)","tier":2,"status":"Negotiations","recent":false},
      {"date":"Feb 12, 2026","club":"Fenerbah\u00e7e","detail":"Fenerbah\u00e7e in advanced talks \u2014 supersedes S\u00e9tif. AJEL still want min \u20ac200k","source":"AfricaFoot (exclusive)","tier":2,"status":"Advanced Negotiations","recent":true},
      {"date":"Feb 13, 2026","club":"Fenerbah\u00e7e","detail":"Turkish media corroborate. 12 apps, 4G 1A in Senegal L1. Near-finalised","source":"Sabah, FotoSpor (citing AfricaFoot)","tier":3,"status":"Corroborated","recent":true}
    ]}
  ]
};
const INTEL_DATA = {
  "1": {"height":"193cm","foot":"\u2014","contract":"\u2014","previousClub":"New Stars FC (academy)","seasonStats":"Key player for Burkina Faso U17 at 2025 FIFA U17 World Cup","clubStanding":"New Stars FC \u2014 Burkinab\u00e8 academy known for producing Ars\u00e8ne Kouassi (Lorient), Alio Souleymane (Nordsj\u00e6lland)","notes":"Imposing 1.93m frame with defensive maturity beyond his age. One of the standout defenders at the U17 World Cup in Qatar. Profile validated by multiple European scouts."},
  "2": {"height":"\u2014","foot":"\u2014","contract":"4.5yr deal with AC Milan (until ~2030)","previousClub":"Be Sport Academy (Senegal)","seasonStats":"Played at youth level in Senegalese system before Milan move","clubStanding":"Signed to Milan Futuro (Serie D pathway). Fee: \u20ac750k + bonuses (up to \u20ac2m total)","notes":"Strong centre-back prospect. Attracted interest from Burnley, Ipswich, Barcelona, RB Leipzig, Lyon and Eintracht Frankfurt before Milan sealed the deal. Captain of Senegal U17 at the World Cup. Confirmed by Fabrizio Romano."},
  "3": {"height":"\u2014","foot":"\u2014","contract":"\u2014","previousClub":"RC Abidjan U19 (academy product)","seasonStats":"Active in Ivorian U19 competition","clubStanding":"RC Abidjan \u2014 established Ivorian club","notes":"Forward on our watchlist. Limited public intel available \u2014 scouting network sourced."},
  "4": {"height":"Imposing physical frame","foot":"Both feet","contract":"\u2014","previousClub":"FC San Pedro (Ivory Coast)","seasonStats":"Featured at 2025 FIFA U17 World Cup for Ivory Coast","clubStanding":"FC San Pedro \u2014 Ivorian Ligue 1 club","notes":"Explosive, direct winger who attacks his marker with both feet. Brother of Gervinho (ex-Arsenal, Roma). Modern winger profile \u2014 can cut inside, cross, and shoot from either side."},
  "5": {"height":"\u2014","foot":"\u2014","contract":"Pre-contract with Hammarby (partnership deal with R\u00e9al du Faso)","previousClub":"R\u00e9al du Faso (academy)","seasonStats":"Starred at 2025 FIFA U17 World Cup \u2014 youngest player at the tournament (b. March 2010). Burkina Faso reached QF","clubStanding":"R\u00e9al du Faso \u2014 top Burkinab\u00e8 academy. Cannot move to Europe until March 2028 (turns 18)","notes":"Likened to Didier Drogba. Generational talent with 10+ elite clubs tracking. Chelsea leading charge over Man United. Hammarby hold a pre-contract + partnership with R\u00e9al du Faso. Long-term deal \u2014 earliest move 2027/2028."},
  "6": {"height":"\u2014","foot":"\u2014","contract":"\u2014","previousClub":"Sahel F.C (Senegal)","seasonStats":"\u2014","clubStanding":"Sahel F.C","notes":"Young prospect (b.2010) on watchlist. Limited public intel \u2014 scouting network sourced."},
  "7": {"height":"\u2014","foot":"\u2014","contract":"\u2014","previousClub":"San Pedro FC (Ivory Coast)","seasonStats":"Active in Ivorian Ligue 1","clubStanding":"San Pedro FC \u2014 same club as Yao Hubert","notes":"Midfielder on watchlist. Limited public intel available."},
  "8": {"height":"\u2014","foot":"\u2014","contract":"\u2014","previousClub":"Derby Academy (Mali)","seasonStats":"\u2014","clubStanding":"Derby Academy \u2014 Malian formation centre","notes":"Defender on watchlist. Limited public intel available."},
  "9": {"height":"\u2014","foot":"\u2014","contract":"~3yr deal with Eintracht Frankfurt (pending)","previousClub":"Acad\u00e9mie Football Players Dreams, Bamako (AFPD)","seasonStats":"Standout at 2025 CAF U17 AFCON and 2025 FIFA U17 World Cup for Mali. Wore #17","clubStanding":"Players Dreams \u2014 rising Malian academy that has produced several Europe-bound talents","notes":"Defensive midfielder known for his engagement and work rate. Initially headed for Randers FC trial, but Frankfurt swooped in. Villarreal and AS Monaco also expressed interest."},
  "10": {"height":"188cm","foot":"Left","contract":"4.5yr deal with Liverpool FC (until ~2030)","previousClub":"Amiti\u00e9 FC (Thi\u00e8s, Senegal) \u2014 club president: Demba Ba","seasonStats":"4 appearances at 2025 FIFA U17 World Cup (all starts). Senegal reached R32","clubStanding":"Liverpool FC U21s under Rob Page. Fee ~\u00a31m + add-ons","notes":"Left-footed CB, 188cm. Compared to Kalidou Koulibaly \u2014 proactive defender who reads play. Strong in duels, comfortable playing out from the back. Minor medical issue on arrival \u2014 not long-term."},
  "11": {"height":"\u2014","foot":"\u2014","contract":"\u2014","previousClub":"Challenge F.C (Senegal)","seasonStats":"\u2014","clubStanding":"Challenge F.C","notes":"Forward on watchlist. Limited public intel available."},
  "12": {"height":"Needs physical development","foot":"\u2014","contract":"\u2014","previousClub":"Diambars FC (Senegal)","seasonStats":"Featured for Senegal at 2025 CAF U17 AFCON. Rated top 3 Senegal U17 prospect by AfricaFoot","clubStanding":"Diambars FC \u2014 elite Senegalese academy (also produced Sidy Barhama Ndiaye \u2192 Liverpool)","notes":"Extraordinarily effective dribbler. Very good in the last 30 metres. Trialled at Man Utd's Carrington (Sep 2025). Eligible for summer 2026 transfer. Needs to add physical size."},
  "13": {"height":"\u2014","foot":"\u2014","contract":"Until Jun 30, 2028 with Aarhus GF","previousClub":"Ugandan youth system \u2192 Aarhus GF (free transfer)","seasonStats":"Playing in AGF U19 Boys League","clubStanding":"Aarhus GF \u2014 Danish Superliga leaders. Transfer officially registered Feb 2, 2026","notes":"Forward who attracted significant interest from PL and European clubs before signing professional terms with AGF. Free transfer."},
  "14": {"height":"\u2014","foot":"\u2014","contract":"\u2014","previousClub":"ISCA (Ivory Coast)","seasonStats":"\u2014","clubStanding":"ISCA","notes":"Midfielder on watchlist. Limited public intel available."},
  "15": {"height":"\u2014","foot":"\u2014","contract":"\u2014","previousClub":"AFA (Angola)","seasonStats":"\u2014","clubStanding":"AFA \u2014 Angolan formation academy","notes":"Defensive midfielder on watchlist. Limited public intel available."},
  "16": {"height":"\u2014","foot":"\u2014","contract":"\u2014","previousClub":"R\u00e9al du Faso (Burkina Faso)","seasonStats":"\u2014","clubStanding":"R\u00e9al du Faso \u2014 same academy as Tapsoba","notes":"Goalkeeper on watchlist. Teammate of Asharaf Loukmane Tapsoba at R\u00e9al du Faso."},
  "17": {"height":"\u2014","foot":"\u2014","contract":"\u2014","previousClub":"G\u00e9n\u00e9ration Foot (Senegal)","seasonStats":"\u2014","clubStanding":"G\u00e9n\u00e9ration Foot \u2014 one of Senegal's most renowned academies (produced Sadio Man\u00e9, Isma\u00efla Sarr)","notes":"Goalkeeper on watchlist. G\u00e9n\u00e9ration Foot pedigree is a strong indicator \u2014 the academy has an elite European pipeline."},
  "18": {"height":"\u2014","foot":"\u2014","contract":"\u2014","previousClub":"Petro Luanda (Angola)","seasonStats":"\u2014","clubStanding":"Petro Luanda \u2014 one of Angola's biggest clubs","notes":"Forward on watchlist. Playing at a top-tier Angolan club \u2014 good platform for visibility."},
  "19": {"height":"\u2014","foot":"\u2014","contract":"\u2014","previousClub":"Rahimo FC (Burkina Faso)","seasonStats":"\u2014","clubStanding":"Rahimo FC \u2014 Burkinab\u00e8 Ligue 1","notes":"Centre-back on watchlist (b.2007 \u2014 older in this cohort). Limited public intel available."},
  "20": {"height":"\u2014","foot":"\u2014","contract":"\u2014","previousClub":"Casa Sports (Senegal)","seasonStats":"\u2014","clubStanding":"Casa Sports \u2014 Senegalese Ligue 1, based in Ziguinchor","notes":"Forward/right winger on watchlist (b.2007 \u2014 older in this cohort). Limited public intel available."},
  "21": {"height":"189cm","foot":"Right","contract":"Until 2028 with AJEL Rufisque","previousClub":"Wally Daan FC (Thi\u00e8s) \u2014 scored 15 goals last season","seasonStats":"4 goals, 1 assist in 12 apps \u2014 top scorer in Senegalese Ligue 1 2025/26","clubStanding":"AJEL Rufisque \u2014 1st place in Senegalese Ligue 1 (24 pts after MD13)","notes":"Known as 'Jude'. DOB: 10 Jan 2009 (passport verified). Elegant and technically strong. Fenerbah\u00e7e in advanced talks (Feb 2026). AJEL valuation: \u20ac200k."}
};

// ── DERIVED DATA ─────────────────────────────────────────────────────
const PLAYERS = PLAYERS_DATA.players;
const INTEL = INTEL_DATA;
const META = PLAYERS_DATA.meta;

// Populate sweep info header
document.getElementById("sweepInfo").textContent =
  "Last updated: " + META.lastSweep + " (Sweep #" + META.sweepNumber + ") \u00b7 " + META.playerCount + " players tracked";

// Populate country filter dynamically from data
(function() {
  const countries = [...new Set(PLAYERS.map(p => p.country))].sort();
  const select = document.getElementById("countryFilter");
  countries.forEach(c => {
    const opt = document.createElement("option");
    opt.value = c;
    opt.textContent = c;
    select.appendChild(opt);
  });
})();

// ── STATE ─────────────────────────────────────────────────────────────
let searchQuery = "";
let statusFilter = "all";
let countryFilter = "all";
let expandedIds = new Set();
let archiveOpen = {};
let intelOpen = {};
let currentView = "players";
let currentSort = "status";
let sortAscending = true;

// ── LAST VISIT TRACKING ──────────────────────────────────────────────
const STORAGE_KEY = "ayt_last_visit";
const SEEN_RUMORS_KEY = "ayt_seen_rumors";
let lastVisitDate = null;
let seenRumorKeys = new Set();

function initLastVisit() {
  try {
    const stored = localStorage.getItem(STORAGE_KEY);
    if (stored) lastVisitDate = new Date(stored);
    const seenStored = localStorage.getItem(SEEN_RUMORS_KEY);
    if (seenStored) seenRumorKeys = new Set(JSON.parse(seenStored));
  } catch(e) {}
}

function saveVisitTimestamp() {
  try {
    localStorage.setItem(STORAGE_KEY, new Date().toISOString());
    const allKeys = [];
    PLAYERS.forEach(p => { p.rumors.forEach(r => { allKeys.push(rumorKey(p.id, r)); }); });
    localStorage.setItem(SEEN_RUMORS_KEY, JSON.stringify(allKeys));
  } catch(e) {}
}

function rumorKey(playerId, rumor) { return playerId + ":" + rumor.date + ":" + rumor.club; }
function isNewRumor(playerId, rumor) { return !seenRumorKeys.has(rumorKey(playerId, rumor)); }
function playerHasNewRumors(player) { return player.rumors.some(r => isNewRumor(player.id, r)); }
window.addEventListener("beforeunload", saveVisitTimestamp);

// ── UTILITIES ────────────────────────────────────────────────────────
function parseDate(str) {
  const cleaned = str.replace("Mid-", "15 ");
  const d = new Date(cleaned);
  return isNaN(d.getTime()) ? new Date(0) : d;
}

function escapeHTML(str) {
  const div = document.createElement("div");
  div.textContent = str;
  return div.innerHTML;
}

// ── FILTERING & SORTING ──────────────────────────────────────────────
function getFilteredPlayers() {
  const q = searchQuery.toLowerCase();
  return PLAYERS.filter(p => {
    if (statusFilter !== "all" && p.status !== statusFilter) return false;
    if (countryFilter !== "all" && p.country !== countryFilter) return false;
    if (q) {
      const inName = p.name.toLowerCase().includes(q);
      const inClub = p.currentClub.toLowerCase().includes(q);
      const inRumors = p.rumors.some(r =>
        r.club.toLowerCase().includes(q) || r.detail.toLowerCase().includes(q)
      );
      if (!inName && !inClub && !inRumors) return false;
    }
    return true;
  });
}

const STATUS_ORDER = { confirmed: 0, active: 1, monitoring: 2, no_rumours: 3 };

function sortPlayers(players) {
  const sorted = [...players];
  sorted.sort((a, b) => {
    let cmp = 0;
    switch (currentSort) {
      case "status":
        cmp = (STATUS_ORDER[a.status] ?? 9) - (STATUS_ORDER[b.status] ?? 9);
        if (cmp === 0) cmp = b.rumors.length - a.rumors.length;
        break;
      case "name": cmp = a.name.localeCompare(b.name); break;
      case "country":
        cmp = a.country.localeCompare(b.country);
        if (cmp === 0) cmp = a.name.localeCompare(b.name);
        break;
      case "rumors": cmp = b.rumors.length - a.rumors.length; break;
    }
    return sortAscending ? cmp : -cmp;
  });
  return sorted;
}

function updateStats(filtered) {
  document.getElementById("stat-confirmed").textContent = filtered.filter(p => p.status === "confirmed").length;
  document.getElementById("stat-active").textContent = filtered.filter(p => p.status === "active").length;
  document.getElementById("stat-total").textContent = filtered.reduce((sum, p) => sum + p.rumors.length, 0);
}

// ── DEEP LINKING ─────────────────────────────────────────────────────
function getHashPlayerId() {
  const hash = window.location.hash;
  if (hash && hash.startsWith("#player-")) {
    const id = parseInt(hash.replace("#player-", ""), 10);
    if (!isNaN(id)) return id;
  }
  return null;
}
function updateHash(id) { if (id !== null) history.replaceState(null, "", "#player-" + id); }
function clearHash() { history.replaceState(null, "", window.location.pathname + window.location.search); }
window.addEventListener("hashchange", function() {
  const id = getHashPlayerId();
  if (id !== null && !expandedIds.has(id)) { expandedIds.add(id); render(); scrollToPlayer(id); }
});
function scrollToPlayer(id) {
  requestAnimationFrame(() => {
    const el = document.querySelector('[data-player-id="' + id + '"]');
    if (el) el.scrollIntoView({ behavior: "smooth", block: "start" });
  });
}

// ── VIEW SWITCHING ───────────────────────────────────────────────────
function switchView(view) {
  currentView = view;
  document.getElementById("tabPlayers").classList.toggle("active", view === "players");
  document.getElementById("tabFeed").classList.toggle("active", view === "feed");
  document.getElementById("tabPlayers").setAttribute("aria-selected", view === "players");
  document.getElementById("tabFeed").setAttribute("aria-selected", view === "feed");
  document.getElementById("playerView").classList.toggle("hidden", view !== "players");
  document.getElementById("feedContainer").classList.toggle("hidden", view !== "feed");
  if (view === "feed") renderFeed(); else render();
}

// ── RENDER HELPERS ───────────────────────────────────────────────────
function tierBadge(tier) {
  return '<span class="mono tier-badge tier-' + tier + '"><span class="dot" aria-hidden="true"></span>Tier ' + tier + '</span>';
}
function statusPill(status) {
  const labels = { confirmed:"CONFIRMED", active:"ACTIVE", monitoring:"MONITORING", no_rumours:"NO RUMOURS" };
  return '<span class="mono status-pill status-' + status + '" role="status">' + (labels[status] || status) + '</span>';
}
function rumorRowHTML(r, isArchive, playerId) {
  const isNew = isNewRumor(playerId, r);
  return '<div class="rumor-row ' + (isArchive ? 'archive' : '') + '">' +
    '<span class="mono rumor-date">' + (isNew ? '<span class="new-rumor-indicator" title="New since last visit"></span>' : '') +
      '<span class="rumor-mobile-label">DATE</span>' + escapeHTML(r.date) + '</span>' +
    '<span class="rumor-club"><span class="rumor-mobile-label">CLUB</span>' + escapeHTML(r.club) + '</span>' +
    '<span class="rumor-detail"><span class="rumor-mobile-label">DETAILS</span>' + escapeHTML(r.detail) + '</span>' +
    '<span class="mono rumor-source"><span class="rumor-mobile-label">SOURCE</span>' + escapeHTML(r.source) + '</span>' +
    '<span class="rumor-tier"><span class="rumor-mobile-label">TIER</span>' + tierBadge(r.tier) + '</span></div>';
}
function intelRow(key, val) {
  const display = (!val || val === "\u2014") ? '<span class="intel-gap">Not yet sourced</span>' : escapeHTML(val);
  return '<div class="intel-row"><span class="mono intel-key">' + escapeHTML(key) + '</span><span class="intel-val">' + display + '</span></div>';
}

function playerCardHTML(p) {
  const isExpanded = expandedIds.has(p.id);
  const archiveRumors = p.rumors.filter(r => !r.recent);
  const recentRumors = p.rumors.filter(r => r.recent);
  const isArchiveOpen = archiveOpen[p.id] || false;
  const isIntelOpen = intelOpen[p.id] || false;
  const rumorCount = p.rumors.length;
  const intel = INTEL[p.id];
  const hasNew = playerHasNewRumors(p);
  let body = "";
  if (isExpanded) {
    body += '<div class="card-body">';
    if (intel) {
      body += '<div class="intel-toggle" onclick="toggleIntel(' + p.id + ', event)" role="button" aria-expanded="' + isIntelOpen + '" tabindex="0" onkeydown="handleKeyToggle(event, function(){ toggleIntel(' + p.id + ', event) })">' +
        '<span class="section-arrow ' + (isIntelOpen ? 'open' : '') + '" aria-hidden="true">\u25b8</span>' +
        '<span class="mono intel-label">PLAYER INTEL</span></div>';
      if (isIntelOpen) {
        body += '<div class="intel-panel">';
        body += '<div class="intel-section-title mono">Bio</div>';
        body += intelRow("Height", intel.height) + intelRow("Foot", intel.foot) + intelRow("Contract", intel.contract) + intelRow("Previous Club", intel.previousClub);
        body += '<div class="intel-section-title mono">Season & Standing</div>';
        body += intelRow("Season Stats", intel.seasonStats) + intelRow("Club Standing", intel.clubStanding);
        body += '<div class="intel-section-title mono">Scouting Notes</div>';
        body += '<div class="intel-notes">' + escapeHTML(intel.notes) + '</div></div>';
      }
    }
    body += '<div class="col-headers mono"><span class="col-header">DATE</span><span class="col-header">CLUB</span><span class="col-header">DETAILS</span><span class="col-header">SOURCE</span><span class="col-header">TIER</span></div>';
    if (archiveRumors.length > 0) {
      body += '<div class="section-toggle" onclick="toggleArchive(' + p.id + ', event)" role="button" aria-expanded="' + isArchiveOpen + '" tabindex="0" onkeydown="handleKeyToggle(event, function(){ toggleArchive(' + p.id + ', event) })">' +
        '<span class="section-arrow ' + (isArchiveOpen ? 'open' : '') + '" aria-hidden="true">\u25b8</span>' +
        '<span class="mono section-label-archive">ARCHIVE (' + archiveRumors.length + ')</span></div>';
      if (isArchiveOpen) archiveRumors.forEach(r => { body += rumorRowHTML(r, true, p.id); });
    }
    if (recentRumors.length > 0) {
      body += '<div class="mono section-label-recent">RECENT</div>';
      recentRumors.forEach(r => { body += rumorRowHTML(r, false, p.id); });
    } else if (archiveRumors.length === 0) {
      body += '<div class="no-rumors">No transfer rumours found in last 60 days</div>';
    }
    body += '</div>';
  }
  return '<div class="player-card" data-player-id="' + p.id + '" style="border-color:' + (isExpanded ? '#1E293B' : 'rgba(30,41,59,0.5)') + '" role="listitem">' +
    '<div class="player-header ' + (isExpanded ? 'expanded' : '') + '" onclick="togglePlayer(' + p.id + ')" role="button" aria-expanded="' + isExpanded + '" tabindex="0" onkeydown="handleKeyToggle(event, function(){ togglePlayer(' + p.id + ') })">' +
      '<div class="player-left"><span class="player-flag" aria-label="' + escapeHTML(p.country) + ' flag">' + p.flag + '</span><div>' +
        '<div class="player-name">' + escapeHTML(p.name) + (hasNew ? '<span class="new-badge">NEW</span>' : '') + '</div>' +
        '<div class="mono player-meta">' + escapeHTML(p.position) + ' \u00b7 ' + p.birthYear + ' \u00b7 ' + escapeHTML(p.currentClub) + '</div>' +
      '</div></div>' +
      '<div class="player-right">' +
        (rumorCount > 0 ? '<span class="mono rumor-count">' + rumorCount + ' rumour' + (rumorCount !== 1 ? 's' : '') + '</span>' : '') +
        statusPill(p.status) +
        '<span class="chevron ' + (isExpanded ? 'open' : '') + '" aria-hidden="true">\u25be</span>' +
      '</div></div>' + body + '</div>';
}

function handleKeyToggle(event, callback) {
  if (event.key === "Enter" || event.key === " ") { event.preventDefault(); callback(); }
}

// ── FEED VIEW ────────────────────────────────────────────────────────
function renderFeed() {
  const filtered = getFilteredPlayers();
  updateStats(filtered);
  const allItems = [];
  filtered.forEach(p => { p.rumors.forEach(r => { allItems.push({ player: p, rumor: r }); }); });
  allItems.sort((a, b) => parseDate(b.rumor.date) - parseDate(a.rumor.date));
  if (allItems.length === 0) {
    document.getElementById("feedContainer").innerHTML = '<div class="no-results">No intel items match your filters.</div>';
    return;
  }
  let html = '<div class="mono list-info" style="margin-bottom:12px">' + allItems.length + ' intel items \u00b7 newest first</div>';
  allItems.forEach(item => {
    const r = item.rumor, p = item.player;
    const isNew = isNewRumor(p.id, r);
    html += '<div class="feed-item"><div class="feed-meta">' +
      '<span class="mono feed-date">' + (isNew ? '<span class="new-rumor-indicator" title="New since last visit"></span>' : '') + r.date + '</span>' +
      '<span class="feed-player-name">' + p.flag + ' ' + escapeHTML(p.name) + '</span>' +
      '<span class="mono feed-player-sub">' + escapeHTML(p.position) + ' \u00b7 ' + p.birthYear + ' \u00b7 ' + escapeHTML(p.currentClub) + '</span>' +
      '</div><div class="feed-content">' +
      '<span class="feed-club">' + escapeHTML(r.club) + '</span>' +
      '<span class="feed-detail">' + escapeHTML(r.detail) + '</span>' +
      '<span class="mono feed-source">' + tierBadge(r.tier) + ' &nbsp;' + escapeHTML(r.source) + '</span>' +
      '</div></div>';
  });
  document.getElementById("feedContainer").innerHTML = html;
}

// ── MAIN RENDER ──────────────────────────────────────────────────────
function render() {
  const filtered = getFilteredPlayers();
  const sorted = sortPlayers(filtered);
  updateStats(filtered);
  document.getElementById("listInfo").textContent = filtered.length + " of " + PLAYERS.length + " players \u00b7 Click to expand";
  const container = document.getElementById("playerContainer");
  if (sorted.length === 0) {
    container.innerHTML = '<div class="no-results">No players match your filters.</div>';
  } else {
    container.innerHTML = sorted.map(p => playerCardHTML(p)).join("");
  }
}

// ── INTERACTIONS ─────────────────────────────────────────────────────
function togglePlayer(id) {
  if (expandedIds.has(id)) { expandedIds.delete(id); clearHash(); }
  else { expandedIds.add(id); updateHash(id); }
  render();
}
function toggleArchive(id, e) { e.stopPropagation(); archiveOpen[id] = !archiveOpen[id]; render(); }
function toggleIntel(id, e) { e.stopPropagation(); intelOpen[id] = !intelOpen[id]; render(); }

// ── EVENT LISTENERS ──────────────────────────────────────────────────
document.getElementById("searchInput").addEventListener("input", function(e) {
  searchQuery = e.target.value;
  if (currentView === "feed") renderFeed(); else render();
});

const FILTER_COLORS = { all:"#8B9EB7", confirmed:"#34D399", active:"#F59E0B", monitoring:"#A78BFA", no_rumours:"#6B7280" };
function applyPillStyles() {
  document.querySelectorAll(".filter-pill").forEach(btn => {
    if (btn.classList.contains("active")) {
      const c = FILTER_COLORS[btn.dataset.status] || "#8B9EB7";
      btn.style.borderColor = c + "66"; btn.style.background = c + "15"; btn.style.color = c;
    } else { btn.style.borderColor = ""; btn.style.background = ""; btn.style.color = ""; }
  });
}
document.querySelectorAll(".filter-pill").forEach(btn => {
  btn.addEventListener("click", function() {
    document.querySelectorAll(".filter-pill").forEach(b => b.classList.remove("active"));
    this.classList.add("active");
    statusFilter = this.dataset.status;
    applyPillStyles();
    if (currentView === "feed") renderFeed(); else render();
  });
});
document.getElementById("countryFilter").addEventListener("change", function() {
  countryFilter = this.value;
  if (currentView === "feed") renderFeed(); else render();
});
document.querySelectorAll(".sort-btn").forEach(btn => {
  btn.addEventListener("click", function() {
    const sort = this.dataset.sort;
    if (currentSort === sort) sortAscending = !sortAscending;
    else { currentSort = sort; sortAscending = true; }
    document.querySelectorAll(".sort-btn").forEach(b => {
      b.classList.remove("active"); b.setAttribute("aria-pressed", "false");
      b.querySelector(".sort-arrow").innerHTML = "&#9660;";
    });
    this.classList.add("active"); this.setAttribute("aria-pressed", "true");
    this.querySelector(".sort-arrow").innerHTML = sortAscending ? "&#9660;" : "&#9650;";
    render();
  });
});

// ── INIT ─────────────────────────────────────────────────────────────
initLastVisit();
applyPillStyles();
const deepLinkId = getHashPlayerId();
if (deepLinkId !== null) expandedIds.add(deepLinkId);
render();
if (deepLinkId !== null) scrollToPlayer(deepLinkId);
</script>
</body>
</html>
